<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ¥è¡¨æ‹–æ‹½åŠŸèƒ½æ¼”ç¤º - BIå¯è§†åŒ–å·¥å…·</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/drag-layout.css">
    <style>
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .demo-header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            border-radius: 12px;
        }
        .demo-header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        .demo-header p {
            font-size: 16px;
            opacity: 0.9;
        }
        .demo-section {
            background: white;
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .demo-section h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #1890ff;
            padding-bottom: 10px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .feature-card {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #1890ff;
        }
        .feature-card h3 {
            color: #1890ff;
            margin-bottom: 10px;
        }
        .step-by-step {
            margin-top: 20px;
        }
        .step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }
        .step-number {
            background: #1890ff;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }
        .step-content {
            flex: 1;
        }
        .live-demo {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .demo-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .btn-demo {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        .btn-primary {
            background: #1890ff;
            color: white;
        }
        .btn-secondary {
            background: #f0f0f0;
            color: #666;
        }
        .btn-demo:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>ğŸ“‹ æŠ¥è¡¨æ‹–æ‹½åŠŸèƒ½æ¼”ç¤º</h1>
            <p>çµæ´»æ‹–åŠ¨æŠ¥è¡¨ä¸­çš„å¡ç‰‡ï¼Œå®ç°ä¸ªæ€§åŒ–å¸ƒå±€é…ç½®</p>
        </div>

        <div class="demo-section">
            <h2>ğŸ¯ åŠŸèƒ½ç‰¹æ€§</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>ğŸ”„ ä¸Šä¸‹å·¦å³æ‹–æ‹½</h3>
                    <p>æ”¯æŒäºŒç»´æ‹–æ‹½æ“ä½œï¼Œå¯ä»¥è‡ªç”±è°ƒæ•´æ•°æ®å¡ç‰‡åœ¨æŠ¥è¡¨ä¸­çš„ä»»æ„ä½ç½®ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ“ æ™ºèƒ½ç½‘æ ¼å¸ƒå±€</h3>
                    <p>è‡ªåŠ¨è°ƒæ•´ç½‘æ ¼ç³»ç»Ÿï¼Œæ”¯æŒçµæ´»çš„äºŒç»´å®šä½å’Œæ™ºèƒ½æ’åˆ—ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ¯ è§†è§‰æŒ‡ç¤ºå™¨</h3>
                    <p>æ‹–æ‹½æ—¶æ˜¾ç¤ºæ–¹å‘æŒ‡ç¤ºå™¨ï¼Œæ¸…æ™°å±•ç¤ºæ”¾ç½®ä½ç½®å’Œæ–¹å‘ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ’¾ å¸ƒå±€ä¿å­˜</h3>
                    <p>è‡ªå®šä¹‰çš„å¸ƒå±€å¯ä»¥ä¿å­˜åˆ°æŠ¥è¡¨é…ç½®ä¸­ï¼Œä¸‹æ¬¡ç¼–è¾‘æ—¶è‡ªåŠ¨åŠ è½½ã€‚</p>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ“ ä½¿ç”¨è¯´æ˜</h2>
            <div class="step-by-step">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>åˆ›å»ºæŠ¥è¡¨</h3>
                        <p>ç‚¹å‡»"åˆ›å»ºæŠ¥è¡¨"æŒ‰é’®ï¼Œé€‰æ‹©"è‡ªå®šä¹‰å¸ƒå±€"æ¨¡æ¿</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>é€‰æ‹©æ•°æ®å¡ç‰‡</h3>
                        <p>å‹¾é€‰éœ€è¦æ·»åŠ åˆ°æŠ¥è¡¨ä¸­çš„æ•°æ®å¡ç‰‡</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>æ‹–æ‹½å¸ƒå±€</h3>
                        <p>ä½¿ç”¨é¼ æ ‡æ‹–åŠ¨å¡ç‰‡å³ä¸Šè§’çš„æ‹–æ‹½æ‰‹æŸ„ï¼ˆâ‹®â‹®ï¼‰ï¼Œæ”¯æŒä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘çš„æ‹–æ‹½å®šä½</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>ä¿å­˜å¸ƒå±€</h3>
                        <p>ç‚¹å‡»"ä¿å­˜å¸ƒå±€"æŒ‰é’®ï¼Œå°†è‡ªå®šä¹‰çš„å¸ƒå±€ä¿å­˜åˆ°æŠ¥è¡¨é…ç½®ä¸­</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ® å®æ—¶æ¼”ç¤º</h2>
            <div class="live-demo">
                <p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ‹–æ‹½å¸ƒå±€æ¼”ç¤ºï¼š</p>
                
                <div class="drag-layout-container">
                    <div class="layout-help">
                        <span class="help-icon">ğŸ’¡</span>
                        <strong>ä½¿ç”¨æç¤ºï¼š</strong>æ‹–æ‹½å¡ç‰‡å³ä¸Šè§’æ‰‹æŸ„å¯è°ƒæ•´ä½ç½®ï¼Œç‚¹å‡»å¡ç‰‡å³ä¸‹è§’æŒ‰é’®å¯è°ƒæ•´å¤§å°
                    </div>
                    <div class="drag-grid" id="demoGrid">
                        <div class="draggable-card" draggable="true" data-card-id="1" data-card-size="normal">
                            <div class="drag-handle">â‹®â‹®</div>
                            <div style="font-size: 24px;">ğŸ“ˆ</div>
                            <div style="font-size: 12px; margin-top: 5px;">é”€å”®æ€»é¢</div>
                            <div style="font-size: 10px; color: #999;">KPIæŒ‡æ ‡å¡</div>
                            <div class="card-actions">
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'full')" title="å…¨å®½">â–£</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'half')" title="åŠå®½">â–¦</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'normal')" title="æ­£å¸¸">â–¡</button>
                            </div>
                        </div>
                        <div class="draggable-card" draggable="true" data-card-id="2" data-card-size="normal">
                            <div class="drag-handle">â‹®â‹®</div>
                            <div style="font-size: 24px;">ğŸ“‰</div>
                            <div style="font-size: 12px; margin-top: 5px;">æœˆåº¦è¶‹åŠ¿</div>
                            <div style="font-size: 10px; color: #999;">æŠ˜çº¿å›¾</div>
                            <div class="card-actions">
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'full')" title="å…¨å®½">â–£</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'half')" title="åŠå®½">â–¦</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'normal')" title="æ­£å¸¸">â–¡</button>
                            </div>
                        </div>
                        <div class="draggable-card" draggable="true" data-card-id="3" data-card-size="normal">
                            <div class="drag-handle">â‹®â‹®</div>
                            <div style="font-size: 24px;">ğŸ“Š</div>
                            <div style="font-size: 12px; margin-top: 5px;">äº§å“å¯¹æ¯”</div>
                            <div style="font-size: 10px; color: #999;">æŸ±çŠ¶å›¾</div>
                            <div class="card-actions">
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'full')" title="å…¨å®½">â–£</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'half')" title="åŠå®½">â–¦</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'normal')" title="æ­£å¸¸">â–¡</button>
                            </div>
                        </div>
                        <div class="draggable-card" draggable="true" data-card-id="4" data-card-size="normal">
                            <div class="drag-handle">â‹®â‹®</div>
                            <div style="font-size: 24px;">ğŸ¥§</div>
                            <div style="font-size: 12px; margin-top: 5px;">å¸‚åœºå æ¯”</div>
                            <div style="font-size: 10px; color: #999;">é¥¼å›¾</div>
                            <div class="card-actions">
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'full')" title="å…¨å®½">â–£</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'half')" title="åŠå®½">â–¦</button>
                                <button class="btn-tiny" onclick="demoSetCardSize(this.parentElement.parentElement, 'normal')" title="æ­£å¸¸">â–¡</button>
                            </div>
                        </div>
                    </div>
                    <div class="layout-actions">
                        <button class="btn-small" onclick="demoResetLayout()">é‡ç½®å¸ƒå±€</button>
                        <button class="btn-small" onclick="demoAutoArrangeLayout()">è‡ªåŠ¨æ’åˆ—</button>
                        <button class="btn-small" onclick="demoSaveLayout()">ä¿å­˜å¸ƒå±€</button>
                    </div>
                </div>
                
                <div class="demo-actions">
                    <button class="btn-demo btn-primary" onclick="window.location.href='reports.html'">
                        ğŸš€ å¼€å§‹ä½¿ç”¨æŠ¥è¡¨é…ç½®
                    </button>
                    <button class="btn-demo btn-secondary" onclick="window.location.href='datacards.html'">
                        ğŸ“Š å…ˆåˆ›å»ºæ•°æ®å¡ç‰‡
                    </button>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ’¡ ä½¿ç”¨åœºæ™¯</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>ğŸ“ˆ é”€å”®ä»ªè¡¨ç›˜</h3>
                    <p>å°†é‡è¦çš„KPIæŒ‡æ ‡æ”¾åœ¨æ˜¾çœ¼ä½ç½®ï¼Œè¶‹åŠ¿å›¾è¡¨æŒ‰é‡è¦ç¨‹åº¦æ’åˆ—</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ›¡ï¸ å®‰å…¨ç›‘æ§</h3>
                    <p>æ ¹æ®ç›‘æ§ä¼˜å…ˆçº§è°ƒæ•´å¡ç‰‡å¸ƒå±€ï¼Œå…³é”®æŒ‡æ ‡ä¼˜å…ˆå±•ç¤º</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ“Š æ•°æ®åˆ†æ</h3>
                    <p>æŒ‰ç…§åˆ†ææµç¨‹ç»„ç»‡å¡ç‰‡é¡ºåºï¼Œæé«˜åˆ†ææ•ˆç‡</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ“‹ æŠ¥å‘Šå±•ç¤º</h3>
                    <p>æ ¹æ®æ±‡æŠ¥é‡ç‚¹è°ƒæ•´å¸ƒå±€ï¼Œçªå‡ºå…³é”®ä¿¡æ¯</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¼”ç¤ºé¡µé¢çš„æ‹–æ‹½åŠŸèƒ½ï¼ˆæ”¯æŒä¸Šä¸‹å·¦å³æ‹–æ‹½ï¼‰
        function initDemoDragAndDrop() {
            const draggableCards = document.querySelectorAll('#demoGrid .draggable-card');
            const dragGrid = document.getElementById('demoGrid');
            
            let draggedCard = null;
            let dragOffsetX = 0;
            let dragOffsetY = 0;
            
            // åˆå§‹åŒ–ç½‘æ ¼å¸ƒå±€
            initDemoGridLayout(dragGrid, draggableCards.length);
            
            draggableCards.forEach(card => {
                // å¼€å§‹æ‹–æ‹½
                card.addEventListener('dragstart', (e) => {
                    draggedCard = card;
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/html', card.innerHTML);
                    
                    // è®¡ç®—æ‹–æ‹½åç§»é‡
                    const rect = card.getBoundingClientRect();
                    dragOffsetX = e.clientX - rect.left;
                    dragOffsetY = e.clientY - rect.top;
                    
                    setTimeout(() => {
                        card.style.opacity = '0.4';
                        card.style.position = 'fixed';
                        card.style.zIndex = '1000';
                        card.style.pointerEvents = 'none';
                    }, 0);
                });
                
                // æ‹–æ‹½ä¸­
                document.addEventListener('dragover', (e) => {
                    if (!draggedCard) return;
                    
                    // æ›´æ–°æ‹–æ‹½å¡ç‰‡ä½ç½®
                    draggedCard.style.left = (e.clientX - dragOffsetX) + 'px';
                    draggedCard.style.top = (e.clientY - dragOffsetY) + 'px';
                    
                    // æ˜¾ç¤ºæ”¾ç½®ä½ç½®æŒ‡ç¤ºå™¨
                    showDemoDropIndicator(e, draggedCard, dragGrid);
                });
                
                // æ‹–æ‹½ç»“æŸ
                card.addEventListener('dragend', (e) => {
                    if (draggedCard) {
                        draggedCard.style.opacity = '1';
                        draggedCard.style.position = '';
                        draggedCard.style.zIndex = '';
                        draggedCard.style.pointerEvents = '';
                        draggedCard.style.left = '';
                        draggedCard.style.top = '';
                        
                        // ç§»é™¤æ‰€æœ‰æ‹–æ‹½æŒ‡ç¤ºå™¨
                        removeDemoDropIndicators(dragGrid);
                    }
                    
                    draggableCards.forEach(c => c.classList.remove('drag-over'));
                    draggedCard = null;
                });
                
                // æ‹–æ‹½ç»è¿‡
                card.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                });
                
                // æ‹–æ‹½è¿›å…¥
                card.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    if (card !== draggedCard) {
                        card.classList.add('drag-over');
                    }
                });
                
                // æ‹–æ‹½ç¦»å¼€
                card.addEventListener('dragleave', (e) => {
                    card.classList.remove('drag-over');
                });
                
                // æ”¾ç½®
                card.addEventListener('drop', (e) => {
                    e.preventDefault();
                    card.classList.remove('drag-over');
                    
                    if (card !== draggedCard) {
                        // è·å–ç›®æ ‡ä½ç½®
                        const targetRect = card.getBoundingClientRect();
                        
                        // åˆ¤æ–­æ”¾ç½®æ–¹å‘ï¼ˆä¸Šä¸‹å·¦å³ï¼‰
                        const dropDirection = getDemoDropDirection(e.clientX, e.clientY, targetRect);
                        
                        // æ ¹æ®æ–¹å‘æ‰§è¡Œä¸åŒçš„æ”¾ç½®é€»è¾‘
                        handleDemoDrop(draggedCard, card, dragGrid, dropDirection);
                    }
                    
                    // ç§»é™¤æ‰€æœ‰æ‹–æ‹½æŒ‡ç¤ºå™¨
                    removeDemoDropIndicators(dragGrid);
                });
            });
        }
        
        // åˆå§‹åŒ–æ¼”ç¤ºç½‘æ ¼å¸ƒå±€
        function initDemoGridLayout(grid, cardCount) {
            // æ ¹æ®å¡ç‰‡æ•°é‡è‡ªåŠ¨è°ƒæ•´ç½‘æ ¼å¸ƒå±€
            const columns = Math.ceil(Math.sqrt(cardCount));
            grid.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
            
            // ä¸ºæ¯ä¸ªå¡ç‰‡è®¾ç½®åˆå§‹ç½‘æ ¼ä½ç½®
            const cards = Array.from(grid.children);
            cards.forEach((card, index) => {
                const row = Math.floor(index / columns) + 1;
                const col = (index % columns) + 1;
                card.style.gridColumn = col;
                card.style.gridRow = row;
            });
        }
        
        // æ˜¾ç¤ºæ¼”ç¤ºæ”¾ç½®ä½ç½®æŒ‡ç¤ºå™¨
        function showDemoDropIndicator(e, draggedCard, grid) {
            // ç§»é™¤ç°æœ‰æŒ‡ç¤ºå™¨
            removeDemoDropIndicators(grid);
            
            const elements = document.elementsFromPoint(e.clientX, e.clientY);
            const targetCard = elements.find(el => el.classList.contains('draggable-card') && el !== draggedCard);
            
            if (targetCard) {
                const rect = targetCard.getBoundingClientRect();
                const dropDirection = getDemoDropDirection(e.clientX, e.clientY, rect);
                
                // åˆ›å»ºæ”¾ç½®æŒ‡ç¤ºå™¨
                const indicator = document.createElement('div');
                indicator.className = 'drop-indicator ' + dropDirection;
                
                // æ ¹æ®æ–¹å‘è®¾ç½®æŒ‡ç¤ºå™¨ä½ç½®
                switch(dropDirection) {
                    case 'left':
                        indicator.style.left = rect.left + 'px';
                        indicator.style.top = rect.top + 'px';
                        indicator.style.width = '4px';
                        indicator.style.height = rect.height + 'px';
                        break;
                    case 'right':
                        indicator.style.left = (rect.left + rect.width) + 'px';
                        indicator.style.top = rect.top + 'px';
                        indicator.style.width = '4px';
                        indicator.style.height = rect.height + 'px';
                        break;
                    case 'top':
                        indicator.style.left = rect.left + 'px';
                        indicator.style.top = rect.top + 'px';
                        indicator.style.width = rect.width + 'px';
                        indicator.style.height = '4px';
                        break;
                    case 'bottom':
                        indicator.style.left = rect.left + 'px';
                        indicator.style.top = (rect.top + rect.height) + 'px';
                        indicator.style.width = rect.width + 'px';
                        indicator.style.height = '4px';
                        break;
                }
                
                document.body.appendChild(indicator);
            }
        }
        
        // ç§»é™¤æ¼”ç¤ºæ‰€æœ‰æ”¾ç½®æŒ‡ç¤ºå™¨
        function removeDemoDropIndicators(grid) {
            const indicators = document.querySelectorAll('.drop-indicator');
            indicators.forEach(indicator => indicator.remove());
        }
        
        // è·å–æ¼”ç¤ºæ”¾ç½®æ–¹å‘
        function getDemoDropDirection(x, y, targetRect) {
            const centerX = targetRect.left + targetRect.width / 2;
            const centerY = targetRect.top + targetRect.height / 2;
            
            const horizontalDistance = Math.abs(x - centerX);
            const verticalDistance = Math.abs(y - centerY);
            
            // åˆ¤æ–­æ˜¯æ°´å¹³æ”¾ç½®è¿˜æ˜¯å‚ç›´æ”¾ç½®
            if (horizontalDistance / targetRect.width > verticalDistance / targetRect.height) {
                // æ°´å¹³æ”¾ç½®
                return x < centerX ? 'left' : 'right';
            } else {
                // å‚ç›´æ”¾ç½®
                return y < centerY ? 'top' : 'bottom';
            }
        }
        
        // å¤„ç†æ¼”ç¤ºæ”¾ç½®æ“ä½œ
        function handleDemoDrop(draggedCard, targetCard, grid, direction) {
            const allCards = Array.from(grid.children);
            const draggedIndex = allCards.indexOf(draggedCard);
            const targetIndex = allCards.indexOf(targetCard);
            
            switch(direction) {
                case 'left':
                    // æ’å…¥åˆ°ç›®æ ‡å·¦ä¾§
                    grid.insertBefore(draggedCard, targetCard);
                    break;
                case 'right':
                    // æ’å…¥åˆ°ç›®æ ‡å³ä¾§
                    if (targetIndex < allCards.length - 1) {
                        grid.insertBefore(draggedCard, targetCard.nextSibling);
                    } else {
                        grid.appendChild(draggedCard);
                    }
                    break;
                case 'top':
                    // æ’å…¥åˆ°ç›®æ ‡ä¸Šæ–¹
                    grid.insertBefore(draggedCard, targetCard);
                    break;
                case 'bottom':
                    // æ’å…¥åˆ°ç›®æ ‡ä¸‹æ–¹
                    if (targetIndex < allCards.length - 1) {
                        grid.insertBefore(draggedCard, targetCard.nextSibling);
                    } else {
                        grid.appendChild(draggedCard);
                    }
                    break;
            }
            
            // æ›´æ–°ç½‘æ ¼å¸ƒå±€
            updateDemoGridLayout(grid);
        }
        
        // æ›´æ–°æ¼”ç¤ºç½‘æ ¼å¸ƒå±€
        function updateDemoGridLayout(grid) {
            const cards = Array.from(grid.children);
            const columns = parseInt(getComputedStyle(grid).gridTemplateColumns.split(' ').length);
            
            cards.forEach((card, index) => {
                const row = Math.floor(index / columns) + 1;
                const col = (index % columns) + 1;
                card.style.gridColumn = col;
                card.style.gridRow = row;
            });
        }
        
        // æ¼”ç¤ºè®¾ç½®å¡ç‰‡å¤§å°
        function demoSetCardSize(card, size) {
            card.setAttribute('data-card-size', size);
            
            // æ ¹æ®å¤§å°è®¾ç½®æ ·å¼
            const grid = document.getElementById('demoGrid');
            if (!grid) return;
            
            switch(size) {
                case 'full':
                    card.style.gridColumn = '1 / -1'; // æ¨ªå‘å¡«æ»¡
                    card.style.gridRow = 'auto';
                    break;
                case 'half':
                    card.style.gridColumn = 'span 2'; // å ç”¨2åˆ—
                    card.style.gridRow = 'auto';
                    break;
                case 'normal':
                    card.style.gridColumn = 'auto';
                    card.style.gridRow = 'auto';
                    break;
            }
            
            // é‡æ–°æ’åˆ—å…¶ä»–å¡ç‰‡
            demoAutoArrangeLayout();
        }
        
        // æ¼”ç¤ºè‡ªåŠ¨æ’åˆ—å¸ƒå±€
        function demoAutoArrangeLayout() {
            const grid = document.getElementById('demoGrid');
            if (!grid) return;
            
            const cards = Array.from(grid.children);
            if (cards.length === 0) return;
            
            // é‡ç½®æ‰€æœ‰å¡ç‰‡ä½ç½®
            cards.forEach(card => {
                card.style.gridColumn = 'auto';
                card.style.gridRow = 'auto';
            });
            
            // æ™ºèƒ½æ’åˆ—ç®—æ³•
            demoSmartArrangeCards(cards, grid);
        }
        
        // æ¼”ç¤ºæ™ºèƒ½æ’åˆ—å¡ç‰‡
        function demoSmartArrangeCards(cards, grid) {
            const maxColumns = 4; // æœ€å¤§åˆ—æ•°
            let currentRow = 1;
            let currentCol = 1;
            
            cards.forEach(card => {
                const size = card.getAttribute('data-card-size') || 'normal';
                let span = 1;
                
                // æ ¹æ®å¡ç‰‡å¤§å°ç¡®å®šè·¨åº¦
                switch(size) {
                    case 'full':
                        span = maxColumns;
                        break;
                    case 'half':
                        span = 2;
                        break;
                    case 'normal':
                        span = 1;
                        break;
                }
                
                // æ£€æŸ¥å½“å‰è¡Œæ˜¯å¦æœ‰è¶³å¤Ÿç©ºé—´
                if (currentCol + span - 1 > maxColumns) {
                    // æ¢è¡Œ
                    currentRow++;
                    currentCol = 1;
                }
                
                // è®¾ç½®å¡ç‰‡ä½ç½®
                card.style.gridColumn = `${currentCol} / span ${span}`;
                card.style.gridRow = currentRow;
                
                // æ›´æ–°åˆ—ä½ç½®
                currentCol += span;
                
                // å¦‚æœå½“å‰è¡Œå·²æ»¡ï¼Œæ¢è¡Œ
                if (currentCol > maxColumns) {
                    currentRow++;
                    currentCol = 1;
                }
            });
            
            // æ›´æ–°ç½‘æ ¼æ¨¡æ¿
            grid.style.gridTemplateColumns = `repeat(${maxColumns}, 1fr)`;
        }
        
        // é‡ç½®å¸ƒå±€
        function demoResetLayout() {
            const dragGrid = document.getElementById('demoGrid');
            const cards = Array.from(dragGrid.children);
            
            // é‡ç½®æ‰€æœ‰å¡ç‰‡å¤§å°å’Œä½ç½®
            cards.forEach(card => {
                card.setAttribute('data-card-size', 'normal');
                card.style.gridColumn = 'auto';
                card.style.gridRow = 'auto';
            });
            
            // æŒ‰åŸå§‹IDæ’åº
            cards.sort((a, b) => {
                const aId = parseInt(a.getAttribute('data-card-id'));
                const bId = parseInt(b.getAttribute('data-card-id'));
                return aId - bId;
            });
            
            // æ¸…ç©ºå¹¶é‡æ–°æ·»åŠ 
            cards.forEach(card => dragGrid.appendChild(card));
            
            // é‡æ–°åˆå§‹åŒ–ç½‘æ ¼å¸ƒå±€
            const columns = Math.ceil(Math.sqrt(cards.length));
            dragGrid.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;
            
            cards.forEach((card, index) => {
                const row = Math.floor(index / columns) + 1;
                const col = (index % columns) + 1;
                card.style.gridColumn = col;
                card.style.gridRow = row;
            });
            
            alert('å¸ƒå±€å·²é‡ç½®ï¼');
        }
        
        // ä¿å­˜å¸ƒå±€
        function demoSaveLayout() {
            const dragGrid = document.getElementById('demoGrid');
            const cards = Array.from(dragGrid.children);
            const cardOrder = cards.map(card => parseInt(card.getAttribute('data-card-id')));
            
            alert(`å¸ƒå±€å·²ä¿å­˜ï¼å½“å‰é¡ºåºï¼š${cardOrder.join(', ')}`);
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ‹–æ‹½
        document.addEventListener('DOMContentLoaded', initDemoDragAndDrop);
    </script>
</body>
</html>